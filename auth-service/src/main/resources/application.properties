# ===================================================================
# Auth Service Configuration
# ===================================================================

# Application
quarkus.application.name=auth-service
quarkus.http.port=8081
quarkus.http.host=0.0.0.0

# ===================================================================
# Database Configuration (PostgreSQL Reactive)
# ===================================================================

quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=postgres
quarkus.datasource.password=postgres

# Reactive PostgreSQL
quarkus.datasource.reactive.url=postgresql://localhost:5432/hospital_db
quarkus.datasource.reactive.max-size=20

# Hibernate ORM
quarkus.hibernate-orm.database.generation=drop-and-create
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.log.bind-parameters=true
quarkus.hibernate-orm.statistics=true
quarkus.hibernate-orm.sql-load-script=no-file

# Flyway (disabled in services - run migrations centrally)
quarkus.flyway.migrate-at-start=false

# ===================================================================
# Consul Service Discovery
# ===================================================================

# Consul Agent
quarkus.consul-config.enabled=true
quarkus.consul-config.agent.host-port=localhost:8500

# Service Registration
quarkus.consul-config.agent.discovery-enabled=true
quarkus.consul-config.agent.service-name=${quarkus.application.name}
quarkus.consul-config.agent.service-host=localhost
quarkus.consul-config.agent.service-port=${quarkus.http.port}

# Health Check
quarkus.consul-config.agent.health-check-interval=10s
quarkus.consul-config.agent.health-check-timeout=5s
quarkus.consul-config.agent.health-check-path=/q/health

# ===================================================================
# JWT Configuration
# ===================================================================

# JWT Issuer and Expiration
jwt.issuer=hospital-system
jwt.expiration-seconds=86400

# SmallRye JWT
mp.jwt.verify.publickey.location=publicKey.pem
mp.jwt.verify.issuer=${jwt.issuer}

# For JWT signing (development - use RS256 in production)
smallrye.jwt.sign.key.location=privateKey.pem

# ===================================================================
# Multi-Tenancy Configuration
# ===================================================================

tenant.default-tenant-id=default-tenant

# ===================================================================
# Authentication Configuration
# ===================================================================

# Account Lockout
auth.lockout-threshold=5
auth.lockout-duration-minutes=30

# ===================================================================
# Redis Configuration (Caching and Rate Limiting)
# ===================================================================

quarkus.redis.hosts=redis://localhost:6379
quarkus.redis.timeout=10s

# Cache Configuration
quarkus.cache.caffeine.users.expire-after-write=1H
quarkus.cache.caffeine.users.maximum-size=1000

# ===================================================================
# RabbitMQ Configuration
# ===================================================================

rabbitmq-host=localhost
rabbitmq-port=5672
rabbitmq-username=admin
rabbitmq-password=admin123
rabbitmq-virtual-host=hospital

# Outgoing Events (User Registration, Updates)
mp.messaging.outgoing.user-events.connector=smallrye-rabbitmq
mp.messaging.outgoing.user-events.exchange.name=hospital.events.direct
mp.messaging.outgoing.user-events.routing-key=user.registered
mp.messaging.outgoing.user-events.exchange.type=direct
mp.messaging.outgoing.user-events.exchange.durable=true
mp.messaging.outgoing.user-events.default-routing-key=user.registered

# ===================================================================
# Health and Metrics
# ===================================================================

# Health Checks
quarkus.smallrye-health.root-path=/q/health

# Prometheus Metrics
quarkus.micrometer.enabled=true
quarkus.micrometer.registry-enabled-default=true
quarkus.micrometer.binder.http-server.enabled=true
quarkus.micrometer.binder.jvm.enabled=true
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/q/metrics

# ===================================================================
# Logging
# ===================================================================

quarkus.log.level=INFO
quarkus.log.category."com.hospital".level=DEBUG
quarkus.log.category."io.smallrye.jwt".level=DEBUG
quarkus.log.console.enable=true
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n

# ===================================================================
# Development Mode
# ===================================================================

%dev.quarkus.log.console.color=true
%dev.quarkus.hibernate-orm.log.sql=true
%dev.quarkus.hibernate-orm.log.bind-parameters=true

# ===================================================================
# Native Build Configuration
# ===================================================================

# Additional build arguments for GraalVM
quarkus.native.additional-build-args=--initialize-at-run-time=org.postgresql.Driver

# Enable all security services for JWT
quarkus.native.enable-all-security-services=true

# ===================================================================
# CORS Configuration (if accessed directly, not via gateway)
# ===================================================================

quarkus.http.cors=true
quarkus.http.cors.origins=http://localhost:3000,http://localhost:8080
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with,x-tenant-id
quarkus.http.cors.exposed-headers=x-request-id
